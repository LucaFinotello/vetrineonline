<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<h2>Modal-box con solo JS/CSS per le Web App in Apps Script</h2>
<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit....</p>
<p>Maecenas nec odio et ante tincidunt tempus....</p>

<button id="btn_open_modal">Apri la modal</button>

<div id="modal" class="modal">
    <div class="modal_wrap">
        <span class="modal_close">×</span>
        <h2>Modal creata in puro Javascript!</h2>
        <p id="modal_content">caricamento...</p>
    </div>
</div>

<script>
    var modal = document.getElementById('modal');
    var btn_open_modal = document.getElementById("btn_open_modal");
    var modal_close = document.getElementsByClassName("modal_close")[0];
    var modal_content = document.getElementById("modal_content");

    btn_open_modal.onclick = function() {
        modal.style.display = "block";
        // richiamo una funzione Apps Script per recuperare il contenuto della modal
        google.script.run.withSuccessHandler(showContentInModal).getModalContent();
    }

    modal_close.onclick = function() { modal.style.display = "none"; }

    // Chiude la modal quando l'utente clicca al di fuori di essa
    window.onclick = function(event) {
        if (event.target == modal) { modal.style.display = "none"; }
    }

    // Se l'esito della chiamata della funzione Apps Script è positivo,
    // visualizzo il contenuto all'intenro della modal
    function showContentInModal(val) { modal_content.innerHTML = val; }
</script>

</body>
</html>